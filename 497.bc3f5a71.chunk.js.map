{"version":3,"file":"497.bc3f5a71.chunk.js","mappings":"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","sources":["webpack:///./src/game/config.ts","webpack:///./src/game/components/camera.tsx","webpack:///./src/assets.ts","webpack:///./src/assets/environment.hdr","webpack:///./src/assets/piece-player-1.png","webpack:///./src/assets/piece-player-2.png","webpack:///./src/game/components/lights.tsx","webpack:///./src/game/components/piece.tsx","webpack:///./src/game/components/board.tsx","webpack:///./src/utils.ts","webpack:///./src/game/game.tsx","webpack:///./src/pages/play.tsx"],"sourcesContent":["import { Vector3 } from \"@react-three/fiber\";\n\nconst config = {\n  board: {\n    cols: 3,\n    rows: 8,\n    voidCols: [0, 2] as number[],\n    voidRows: [4, 5] as number[],\n    tileSize: [1, 0.75, 1] as [width: number, height: number, depth: number],\n    pieceRadiusRatio: 0.75,\n    pieceHeightRatio: 0.2,\n    pieceTextureRatio: 1.5,\n    pieceColors: [\"#86868f\", \"#dbd8bd\"],\n    color: \"#bab8a1\",\n  },\n  camera: {\n    position: [0, 7, 7] as Vector3,\n  },\n} as const;\n\nexport default config;\n","import React from \"react\";\nimport { OrbitControls, PerspectiveCamera } from \"@react-three/drei\";\nimport config from \"@/game/config\";\n\nexport default function Camera() {\n  return (\n    <>\n      <PerspectiveCamera makeDefault position={config.camera.position} />\n      <OrbitControls makeDefault />\n    </>\n  );\n}\n","import environment from \"@/assets/environment.hdr\";\nimport piecePlayer1 from \"@/assets/piece-player-1.png\";\nimport piecePlayer2 from \"@/assets/piece-player-2.png\";\n\nconst assets = {\n  environment,\n  piecePlayer1,\n  piecePlayer2,\n};\n\nexport default assets;\n","export default __webpack_public_path__ + \"environment.bec864da.hdr\";","export default __webpack_public_path__ + \"piece-player-1.17b38c41.png\";","export default __webpack_public_path__ + \"piece-player-2.f80f84fb.png\";","import React from \"react\";\nimport { Environment } from \"@react-three/drei\";\nimport assets from \"@/assets\";\n\nexport default function Lights() {\n  return (\n    <>\n      <ambientLight />\n      <Environment files={assets.environment} />\n    </>\n  );\n}\n","import React from \"react\";\nimport * as THREE from \"three\";\nimport { useThree } from \"@react-three/fiber\";\nimport { useTexture } from \"@react-three/drei\";\nimport { Piece as PieceType } from \"@/types\";\nimport assets from \"@/assets\";\nimport config from \"@/game/config\";\n\ntype Props = {\n  piece: PieceType;\n};\n\nexport default function Piece({ piece }: Props) {\n  const gl = useThree((state) => state.gl);\n\n  const textures = useTexture([assets.piecePlayer1, assets.piecePlayer2]);\n  React.useMemo(() => {\n    textures.forEach((texture) => {\n      texture.anisotropy = gl.capabilities.getMaxAnisotropy();\n    });\n  }, [textures, gl]);\n  const settings = React.useMemo(() => {\n    const radius = config.board.tileSize[0] * 0.5 * config.board.pieceRadiusRatio;\n    return {\n      radius,\n      height: config.board.tileSize[1] * config.board.pieceHeightRatio,\n      textureSize: radius * config.board.pieceTextureRatio,\n    };\n  }, []);\n\n  return (\n    <>\n      <mesh>\n        <cylinderGeometry args={[settings.radius, settings.radius, settings.height, 32, 32]} />\n        <meshStandardMaterial color={config.board.pieceColors[piece.playerIndex]} />\n      </mesh>\n      <group position-y={settings.height / 2}>\n        <mesh renderOrder={1} rotation-x={THREE.MathUtils.degToRad(-90)}>\n          <planeGeometry args={[settings.textureSize, settings.textureSize]} />\n          <meshStandardMaterial\n            depthWrite={false}\n            depthTest={false}\n            transparent={true}\n            map={textures[piece.playerIndex]}\n          />\n        </mesh>\n      </group>\n    </>\n  );\n}\n","import React from \"react\";\nimport * as THREE from \"three\";\nimport { Piece as PieceType } from \"@/types\";\nimport { shuffleArray } from \"@/utils\";\nimport Piece from \"@/game/components/piece\";\nimport config from \"@/game/config\";\n\nexport default function Board() {\n  const tiles = React.useMemo(() => {\n    return Array.from(Array(config.board.cols)).map((_, col) => {\n      return Array.from(Array(config.board.rows)).map((_, row) => {\n        return {\n          col,\n          row,\n          void: config.board.voidCols.includes(col) && config.board.voidRows.includes(row),\n        };\n      });\n    });\n  }, []);\n\n  const [pieces, setPieces] = React.useState<PieceType[]>([]);\n\n  React.useEffect(() => {\n    const testPlayerIndices = [0, 1];\n    setPieces(\n      shuffleArray(tiles.flat().filter((tile) => !tile.void))\n        .slice(0, 5)\n        .map((tile, index) => {\n          return {\n            playerIndex: testPlayerIndices[index % 2],\n            col: tile.col,\n            row: tile.row,\n          };\n        })\n    );\n  }, [tiles]);\n\n  return (\n    <group\n      position-x={config.board.tileSize[0] * (-(config.board.rows - 1) / 2)}\n      position-z={config.board.tileSize[0] * ((config.board.cols - 1) / 2)}\n    >\n      <group rotation-y={THREE.MathUtils.degToRad(90)}>\n        {tiles.map((rows, col) => {\n          return (\n            <group key={col} position-x={config.board.tileSize[0] * col}>\n              {rows.map((tile, index) => {\n                if (tile.void) {\n                  return <React.Fragment key={index}></React.Fragment>;\n                }\n                const piece = pieces.find((piece) => {\n                  return piece.col == tile.col && piece.row === tile.row;\n                });\n                return (\n                  <group key={index} position-z={tile.row * config.board.tileSize[0]}>\n                    <mesh>\n                      <boxGeometry args={config.board.tileSize} />\n                      <meshStandardMaterial color={config.board.color} />\n                    </mesh>\n                    {piece !== undefined && (\n                      <group\n                        position-y={\n                          config.board.tileSize[1] / 2 + (config.board.tileSize[1] * config.board.pieceHeightRatio) / 2\n                        }\n                      >\n                        <Piece piece={piece} />\n                      </group>\n                    )}\n                  </group>\n                );\n              })}\n            </group>\n          );\n        })}\n      </group>\n    </group>\n  );\n}\n","export function shuffleArray<T = any>(array: T[]): T[] {\n  for (let i = array.length - 1; i > 0; i--) {\n    const j = Math.floor(Math.random() * (i + 1));\n    [array[i], array[j]] = [array[j], array[i]];\n  }\n  return array;\n}\n","import React from \"react\";\nimport { Canvas } from \"@react-three/fiber\";\nimport Camera from \"@/game/components/camera\";\nimport Lights from \"@/game/components/lights\";\nimport Board from \"@/game/components/board\";\n\nexport default function Game() {\n  return (\n    <Canvas flat linear legacy>\n      <Lights />\n      <Camera />\n      {/* todo: add a fallback loading component */}\n      <React.Suspense fallback={<></>}>\n        <Board />\n      </React.Suspense>\n    </Canvas>\n  );\n}\n","import React from \"react\";\nimport Game from \"@/game/game\";\n\nexport default function Play() {\n  return (\n    <main>\n      <Game />\n    </main>\n  );\n}\n"],"names":["board","cols","rows","voidCols","voidRows","tileSize","pieceRadiusRatio","pieceHeightRatio","pieceTextureRatio","pieceColors","color","camera","position","Camera","React","PerspectiveCamera","makeDefault","config","OrbitControls","environment","piecePlayer1","piecePlayer2","Lights","Environment","files","assets","Piece","_ref","piece","gl","useThree","state","textures","useTexture","forEach","texture","anisotropy","capabilities","getMaxAnisotropy","settings","radius","height","textureSize","args","playerIndex","renderOrder","THREE","depthWrite","depthTest","transparent","map","Board","tiles","Array","from","_","col","row","void","pieces","setPieces","testPlayerIndices","array","i","length","j","Math","floor","random","shuffleArray","flat","filter","tile","slice","index","key","find","undefined","Game","Canvas","linear","legacy","fallback","Play"],"sourceRoot":""}